package {{ .PackageName }}

import (
  "context"
  "database/sql"
)

// Execer is the common interface to execute a query without returning any row.
type Execer interface {
  ExecContext(ctx context.Context, query string, args ...interface{}) (sql.Result, error)
}

// Queryer is the common interface to execute a query returning row(s).
type Queryer interface {
  QueryContext(ctx context.Context, query string, args ...interface{}) (*sql.Rows, error)
  QueryRowContext(ctx context.Context, query string, args ...interface{}) *sql.Row
}

// ColumnScanner represents a collection of columns that can be scanned into from a row.
type ColumnScanner interface {
  // PreScan appends all columns to dest for scanning.
  PreScan(dest *[]interface{})

  // PostScan must be called after scanning to do some extra processsing.
  PostScan() error
}

// TableRow represents a table's row.
type TableRow interface {
  ColumnScanner

  // TableMeta returns the table's meta information.
  TableMeta() *TableMeta

  // Valid returns true if this is a valid table row (e.g. not NULL).
  Valid() bool

  // ColumnValue returns the i-th column value.
  ColumnValue(i int) interface{}

  // ColumnPointer returns the i-th column's pointer.
  ColumnPointer(i int) interface{}

}

// TableRowWithPrimary represents row of table with primary key.
type TableRowWithPrimary interface {
  TableRow

  // PrimaryValue returns the primary key value of this row.
  // The returned value is comparable by values.
  PrimaryValue() interface{}
}

// Slicer represents an appendable slice.
type Slicer interface {
  // Len returns the length of the slice.
  Len() int

  // Item returns the i-th item of the slice. i should be within [0, Len()), otherwise a panic will be raised.
  Item(i int) interface{}

  // Append an item to the slice. If item is nil, then an empty item should be appended.
  Append(item interface{})
}

// Slicers represents a slice of Slicer.
type Slicers interface {
  // Len returns the number of Slicer.
  Len() int

  // Slicer returns the i-th Slicer.
  Slicer(i int) Slicer

  // Append appends an empty Slicer.
  Append()
}
